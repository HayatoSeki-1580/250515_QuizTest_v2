<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>社内学習ブラウザ</title>
    <style>
        /* CSSを追加して見た目を整えることができます */
        body {
            font-family: sans-serif;
            line-height: 1.6;
            padding: 20px;
            background-color: #f4f4f4;
            color: #333;
            display: flex;
            justify-content: center;
            align-items: flex-start; /* 上部に寄せる */
            min-height: 100vh; /* 画面いっぱいに */
        }
        #quiz-container {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            max-width: 600px; /* コンテンツ幅を制限 */
            width: 100%; /* レスポンシブ対応 */
        }
        #question-container {
            margin-bottom: 20px;
        }
        #question-title {
            color: #0056b3;
            margin-bottom: 15px;
            border-bottom: 2px solid #0056b3;
            padding-bottom: 10px;
        }
        #question-text {
            margin-bottom: 20px;
            white-space: pre-wrap; /* 改行を反映 */
        }
        #options-container label {
            display: block;
            margin-bottom: 12px;
            cursor: pointer;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 5px;
            transition: background-color 0.3s ease;
        }
        #options-container label:hover {
            background-color: #e9e9e9;
        }
        #options-container input[type="radio"] {
            margin-right: 10px;
            vertical-align: middle;
        }
        .option-text {
             vertical-align: middle;
        }
        #result {
            margin-top: 20px;
            padding: 10px;
            border-radius: 5px;
            font-weight: bold;
            min-height: 1.5em; /* 結果表示エリアの高さを確保 */
        }
        #result.correct {
            color: green;
            background-color: #d4edda;
            border-color: #c3e6cb;
        }
        #result.incorrect {
            color: red;
            background-color: #f8d7da;
            border-color: #f5c6cb;
        }
        #check-button, #next-button, #reset-button {
            display: inline-block;
            margin-top: 20px;
            padding: 12px 20px;
            font-size: 16px;
            color: #fff;
            background-color: #007bff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        #check-button:hover, #next-button:hover, #reset-button:hover {
            background-color: #0056b3;
        }
         #check-button:disabled {
            background-color: #cccccc;
            cursor: not-allowed;
        }
        #next-button {
             background-color: #28a745;
        }
        #next-button:hover {
             background-color: #218838;
        }
         #reset-button {
            background-color: #ffc107;
            color: #212529;
        }
        #reset-button:hover {
            background-color: #e0a800;
        }

        #quiz-end-message {
            margin-top: 30px;
            text-align: center;
        }
        #quiz-end-message h2 {
            color: #0056b3;
            margin-bottom: 15px;
        }
        #final-score {
            font-size: 1.2em;
            margin-bottom: 20px;
        }
        .correct-answer {
            color: green;
            font-weight: bold;
        }

        /* レスポンシブ対応 */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }
            #quiz-container {
                padding: 20px;
            }
            #check-button, #next-button, #reset-button {
                width: 100%;
                text-align: center;
                margin-top: 15px;
            }
        }
    </style>
</head>
<body>

    <div id="quiz-container">
        <div id="question-container">
            <h2 id="question-title"></h2>
            <p id="question-text"></p>
            <div id="options-container">
                </div>
            <button id="check-button">回答する</button>
            <div id="result"></div>
            <button id="next-button" style="display: none;">次の問題へ</button>
        </div>

        <div id="quiz-end-message" style="display: none;">
            <h2>クイズ終了！</h2>
            <p id="final-score"></p>
            <button id="reset-button">もう一度挑戦する</button>
        </div>
    </div>

    <script>
        // JSONデータをJavaScript変数として直接埋め込みます
        const quizData = [
            {
                "問題番号": "問1",
                "年度": "第59回(平成21年)",
                "問題文": "次の記述は、計量法第1条の目的に関するものであるが、(ア)~(ウ)に入る語句の組合せとして正しいものを一つ選べ。\nこの法律は、計量の(ア)を定め、適正な(イ)を確保し、もって(ウ)に寄与することを目的とする。",
                "選択肢": [
                    "(ア)標準\n(イ)計量の実施\n(ウ)社会経済の発展及び生活水準の向上",
                    "(ア)基準\n(イ)計量の実施\n(ウ)経済の発展及び文化の向上",
                    "(ア)基準\n(イ)計量器の校正\n(ウ)社会経済の発展及び生活水準の向上",
                    "(ア)基準\n(イ)計量器の供給\n(ウ)経済の発展及び文化の向上",
                    "(ア)標準\n(イ)計量器の供給\n(ウ)社会経済の発展及び生活水準の向上"
                ],
                "正解": "2"
            },
            {
                "問題番号": "問2",
                "年度": "第59回(平成21年)",
                "問題文": "計量法の用語の定義に関する次のア~オの記述のうち、誤っているものの組合せを次の1~5の中から一つ選べ。\nア この法律において「取引」とは、公に又は業務上他人に一定の事実が真実で\nある旨を表明することをいう。\n\nイ この法律において「計量単位」とは、計量の基準となるものをいう。\nウ この法律で定める「物象の状態の量」には、速さは含まれない。\nエ この法律において「特定計量器」とは、取引若しくは証明における計量に使用され、又は主として一般消費者の生活の用に供されるすべての計量器をいう。\nオ この法律において「標準物質」とは、政令で定める物象の状態の量の特定の値が付された物質であって、当該物象の状態の量の計量をするための計量器の誤差の測定に用いるものをいう。",
                "選択肢": [
                    "ア、イ、エ、オ",
                    "ア、ウ、工",
                    " ア、ウ、オ",
                    " イ、エ、オ",
                    " イ、ウ、工"
                ],
                "正解": "2"
            },
            {
                "問題番号": "問3",
                "年度": "第59回(平成21年)",
                "問題文": "次の記述は、非法定計量単位の使用の禁止に関する計量法第8条第1項の規定であるが、(ア) 及び (イ)に入る語句の組合せとして正しいものを一つ選べ。\n第3条から第5条までに規定する計量単位(以下「法定計量単位」という。)以外の計量単位(以下「非法定計量単位」という。)は、第2条第1項第1号に掲げる物象の状態の量について、(7) 又は(イ)に用いてはならない。",
                "選択肢": [
                    "(ア)計量\n(イ)計測",
                    "(ア)校正\n(イ)検定",
                    "(ア)取引\n(イ)証明",
                    "(ア)報告\n(イ)表示",
                    "(ア)販売\n(イ)陳列"
                ],
                "正解": "3"
            }
        ];

        let questions = []; // quizDataをここにコピーして使用します
        let currentQuestionIndex = -1; // 現在の問題のインデックス
        let correctAnswers = 0; // 正答数
        let answered = false; // 回答済みフラグ

        // DOM要素の取得
        const questionContainer = document.getElementById('question-container');
        const questionTitle = document.getElementById('question-title');
        const questionText = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const resultDiv = document.getElementById('result');
        const checkButton = document.getElementById('check-button');
        const nextButton = document.getElementById('next-button');
        const quizEndMessage = document.getElementById('quiz-end-message');
        const finalScore = document.getElementById('final-score');
        const resetButton = document.getElementById('reset-button');

        // ボタンにイベントリスナーを設定
        checkButton.addEventListener('click', checkAnswer); // onclick属性からイベントリスナーに変更
        nextButton.addEventListener('click', loadNextQuestion);
        resetButton.addEventListener('click', resetQuiz); // onclick属性からイベントリスナーに変更

        // クイズを初期化し、データを設定する関数
        function initQuiz() {
            // 埋め込み済みのquizDataを使用します
            questions = quizData;

            if (questions.length > 0) {
                // データがあれば最初の問題をロードしてクイズを開始
                loadNextQuestion();
            } else {
                // データが空の場合のエラーハンドリング
                console.error('クイズデータが空です。');
                if (resultDiv) {
                    resultDiv.textContent = '問題データが見つかりませんでした。';
                }
                if (questionContainer) {
                    questionContainer.style.display = 'none';
                }
                if (checkButton) {
                    checkButton.style.display = 'none';
                }
                if (nextButton) {
                    nextButton.style.display = 'none';
                }
                if (quizEndMessage) {
                    quizEndMessage.style.display = 'block';
                }
                if (finalScore) {
                    finalScore.textContent = 'エラーが発生しました。';
                }
                if (resetButton) {
                    resetButton.style.display = 'none'; // データがない場合はリセットも不要
                }
            }
        }


        function loadNextQuestion() {
            answered = false;
            currentQuestionIndex++;

            // 結果表示と「次へ」ボタンをクリア/非表示
            if (resultDiv) {
                resultDiv.textContent = '';
                resultDiv.className = ''; // スタイルクラスもリセット
            }
            if (nextButton) nextButton.style.display = 'none';
             if (checkButton) {
                 checkButton.style.display = 'inline-block'; // 回答ボタンを表示
                 checkButton.disabled = false; // 回答ボタンを有効化
            }


            // オプションコンテナの内容をクリア
            if (optionsContainer) {
                 optionsContainer.innerHTML = '';
            }


            if (currentQuestionIndex < questions.length) {
                // 問題表示モード
                if (quizEndMessage) quizEndMessage.style.display = 'none';
                if (questionContainer) questionContainer.style.display = 'block';
                if (resetButton) resetButton.style.display = 'none'; // リセットボタンを非表示


                const currentQuestion = questions[currentQuestionIndex];
                if (questionTitle) questionTitle.textContent = `${currentQuestion.年度} ${currentQuestion.問題番号}`;
                // 改行文字を<br>タグに変換
                if (questionText) questionText.innerHTML = currentQuestion.問題文.replace(/\n/g, '<br>');

                // 選択肢を動的に生成
                if (optionsContainer && currentQuestion.選択肢) {
                    currentQuestion.選択肢.forEach((optionText, index) => {
                        const label = document.createElement('label');
                        const input = document.createElement('input');
                        input.type = 'radio';
                        input.name = 'answer';
                        input.value = (index + 1).toString(); // 選択肢の値を1から5に設定

                        const span = document.createElement('span');
                        span.className = 'option-text';
                        span.textContent = `${index + 1}. ${optionText}`;

                        label.appendChild(input);
                        label.appendChild(span);
                        optionsContainer.appendChild(label);
                    });
                }

            } else {
                // クイズ終了モード
                if (questionContainer) questionContainer.style.display = 'none';
                if (checkButton) checkButton.style.display = 'none'; // 回答ボタンを非表示
                if (nextButton) nextButton.style.display = 'none'; // 次へボタンも念のため非表示

                if (finalScore) finalScore.textContent = `正答数: ${correctAnswers} / ${questions.length}`;
                if (quizEndMessage) quizEndMessage.style.display = 'block';
                if (resetButton) resetButton.style.display = 'block'; // リセットボタンを表示
            }
        }

        function checkAnswer() {
            if (!answered) {
                const selectedAnswer = document.querySelector('input[name="answer"]:checked');
                const optionsLabels = optionsContainer ? optionsContainer.querySelectorAll('label') : []; // label要素を取得、optionsContainer存在確認

                // 一旦すべての選択肢のスタイルをリセット
                optionsLabels.forEach(label => {
                    label.classList.remove('correct-answer');
                    label.style.color = '';
                    label.style.fontWeight = '';
                });

                if (selectedAnswer) {
                    const correctAnswer = questions[currentQuestionIndex].正解;
                    const selectedValue = selectedAnswer.value;

                    if (resultDiv) { // resultDiv存在確認
                        if (selectedValue === correctAnswer) {
                            resultDiv.textContent = '正解です！';
                            resultDiv.className = 'result correct'; // 正解スタイルを適用
                            correctAnswers++;
                        } else {
                            resultDiv.textContent = `不正解です。正解は ${correctAnswer} です。`;
                            resultDiv.className = 'result incorrect'; // 不正解スタイルを適用
                        }
                    }

                    // 正解の選択肢を強調表示
                    const correctOptionIndex = parseInt(correctAnswer) - 1;
                    if (correctOptionIndex >= 0 && correctOptionIndex < optionsLabels.length) {
                        optionsLabels[correctOptionIndex].classList.add('correct-answer');
                         // CSSクラスでスタイルを管理
                    }

                    if (nextButton) nextButton.style.display = 'block'; // 「次の問題」ボタンを表示
                    answered = true;
                    if (checkButton) checkButton.style.display = 'none'; // 回答ボタンを非表示

                } else {
                     if (resultDiv) { // resultDiv存在確認
                        resultDiv.textContent = '回答を選択してください。';
                        resultDiv.className = 'result'; // スタイルをリセット
                    }
                }
            }
        }

        function resetQuiz() {
            currentQuestionIndex = -1;
            correctAnswers = 0;
            // クイズ終了メッセージを非表示
            if (quizEndMessage) quizEndMessage.style.display = 'none';
            // 最初の問題表示に戻る
            loadNextQuestion();
        }

        // ページ読み込み完了後にクイズを初期化し、データを設定
        initQuiz();
    </script>

</body>
</html>
